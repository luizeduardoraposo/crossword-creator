# AI agent guide for this repo

Purpose: small Node.js scripts to analyze a Portuguese word list (`words-ptbr.txt`) and brute‑force pack words into an N×N grid (crossword/word-search style).

## Stack and conventions
- Runtime: Node.js, CommonJS modules (`require`/`module.exports`). No `package.json` or external deps.
- Data: `words-ptbr.txt` (UTF‑8, one word per line, may include diacritics like á, ç, ã).
- Style/patterns:
  - Synchronous file I/O is used for simplicity in CLI scripts.
  - Unicode normalization to A–Z via `String.normalize('NFD')` and diacritic stripping when computing frequencies.
  - Grids are `Array(N)` of `Array(N)` with cells as `null` or uppercase letters. Word placements are arrays of `[row, col]` coordinates in 8 directions.

## Key files
- `script-calc-freq.js` — computes letter frequencies A–Z from `words-ptbr.txt`.
  - Exports: `calcularFrequenciaLetras(file)`, `salvarResultadoComoObjetoJS(input, output?)`.
  - CLI: prints frequencies; use `--save` (or `--salvar`) to write `letter-freq.js`.
- `letter-freq.js` — generated by the script above. Do not edit manually; rerun the generator.
- `script.js` — `drawRandomWords()` picks 300 unique random words from `words-ptbr.txt`.
  - Note: `totalLines` is hard-coded (245300) and uses 0‑based indices; update if the source file size changes.
- `wordgrid-bruteforce.js` — brute‑force placer.
  - Export: `findBestPlacement(words, N=4, { maxTimeMs=5000, maxAttempts=1e6, verbose=false })`.
  - Returns `{ grid, insertedWords, stats: { count, attempts, timeMs, cutoffReached } }`.
  - When run directly, loads all words and attempts a placement, then prints the grid and statistics.

## How to run (Windows cmd)
- Compute and print frequencies:
  - `node script-calc-freq.js`
- Compute and save `letter-freq.js`:
  - `node script-calc-freq.js --save`
- Run brute‑force placer with defaults (N=4):
  - `node wordgrid-bruteforce.js`

## Usage examples in code
- Frequencies: `const { calcularFrequenciaLetras } = require('./script-calc-freq'); const f = calcularFrequenciaLetras('words-ptbr.txt');`
- Draw words: `const { drawRandomWords } = require('./script'); const words = drawRandomWords();`
- Place words: `const { findBestPlacement } = require('./wordgrid-bruteforce'); const res = findBestPlacement(words, 4, { maxTimeMs: 10000 });`

## Project‑specific notes and gotchas
- `letter-freq.js` is generated; keep header/timestamp and values by rerunning the generator instead of manual edits.
- `wordgrid-bruteforce.js` currently contains minor duplication (e.g., repeated `DIRECTIONS`) and a stubbed progress‑logging patch that isn’t wired; prefer simplifying to a single set of helpers if refactoring, but keep the exported API stable.
- Heuristic `canFit` is simplistic; you may improve pruning, but avoid changing `findBestPlacement`’s signature.
- Large inputs: scripts read entire files synchronously; if you stream/optimize, preserve output shape and side effects.
- All coordinates and indices are 0‑based; grid cells use uppercase letters; null represents empty.

## Integration hints
- `letter-freq.js` can be used to order candidate words (e.g., rarer letters first) to improve packing; not currently applied.
- `script.js` + `wordgrid-bruteforce.js` combine to “sample then place” workflows.

If anything here seems off or incomplete (e.g., desired CLI flags, target Node version, or logging behavior), tell me what to clarify and I’ll update this file.
